<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Για Εσένα 💘</title>

  <meta name="theme-color" content="#ff3b6b" />
  <meta name="description" content="Ένα μικρό δώρο για σένα 💘" />

  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />

  <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192.png?v=2">
  <link rel="apple-touch-icon" sizes="512x512" href="icons/icon-512.png?v=2">

  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png?v=2">
  <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png?v=2">
</head>

<body>

  <!-- LOCK SCREEN -->
  <div class="lockScreen" id="lockScreen">
    <div class="lockCard">
      <div class="lockEmoji">🔐💘</div>
      <div class="lockTitle">Μόνο για εμάς</div>
      <div class="lockText">Βάλε την ημερομηνία που ξεκίνησαν όλα…</div>

      <input
        type="text"
        id="lockInput"
        placeholder="π.χ. **/*/**"
        inputmode="numeric"
        autocomplete="off"
      />

      <button class="btn primary" id="lockBtn" type="button">Ξεκλείδωσε 💕</button>

      <div class="lockError hidden" id="lockError">
        ❌ Όχι μωρό… δοκίμασε ξανά 💘
      </div>
    </div>
  </div>

  <!-- INTRO / MODE SELECT OVERLAY -->
  <div class="intro" id="intro">
    <div class="introCard">
      <div class="introGift" aria-hidden="true">
        <div class="introGlow"></div>
        <div class="introEmoji">🎁</div>
      </div>

      <div class="introTitle">Πώς θέλεις να μπούμε σήμερα;</div>
      <div class="introText">Διάλεξε ένα από τα δύο… 💘</div>

      <div class="modeBtns">
        <button class="btn primary introBtn" id="btnValentine" type="button">🩷 Άγιος Βαλεντίνος</button>
        <button class="btn ghost introBtn" id="btnUs" type="button">🤍 Εμείς</button>
      </div>

      <div class="introHint">διάλεξε για να συνεχίσεις</div>
    </div>
  </div>

  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">💘</div>
        <div class="brandText">
          <div class="brandTitle">Το δώρο μου</div>
          <div class="brandSub" id="brandSub">για εσένα</div>
        </div>
      </div>

      <div class="miniProgress">
        <div class="progressBar" aria-hidden="true">
          <div class="progressFill" id="progressFill"></div>
        </div>
        <div class="progressText" id="progressText">1 / 7</div>
      </div>
    </header>

    <main class="main">

      <!-- STEP 0: HEART -->
      <section class="step active" id="stepHeart">
        <div class="card hero oneCol heartStep">
          <div class="heartWrap" id="heartWrap" aria-label="Κράτα πατημένη την καρδιά">
            <div class="heartGlow"></div>

            <svg class="ring" viewBox="0 0 120 120" aria-hidden="true">
              <circle class="ringTrack" cx="60" cy="60" r="46"></circle>
              <circle class="ringFill" id="ringFill" cx="60" cy="60" r="46"></circle>
            </svg>

            <div class="heartIcon" id="heartIcon">❤️</div>
            <div class="sparks" id="sparks" aria-hidden="true"></div>
          </div>

          <div class="heartText" id="heartText">
            Υπάρχουν στιγμές που αξίζει<br>να τις νιώσεις πρώτα.
          </div>

          <div class="photoReveal" id="photoReveal">
            <img id="revealImg" src="assets/slide1.jpg" alt="Η στιγμή μας" />
            <div class="holdHint" id="holdHint"></div>
          </div>
        </div>
      </section>

      <!-- STEP 1: PUZZLE -->
      <section class="step" id="step2">
        <div class="card reveal">
          <div class="revealTitle">🧩 Μπεμπικινάκι μου</div>

          <div class="puzzleWrap">
            <div class="puzzleTop">
              <div class="puzzleText" id="puzzleText">
                Φτιάξε την φωτογραφία για να συνεχίσουμε…Αν και δεν είσαι καλή στα Παζλ 💘
              </div>
              <div class="puzzleBadge" id="puzzleBadge">0/6</div>
            </div>

            <div class="puzzleBoard" id="puzzleBoard" aria-label="Puzzle φωτογραφίας"></div>
          </div>

          <div class="puzzleActions">
            <button class="btn ghost" id="btnPuzzleReset" type="button">Ξανά 🔄</button>
            <button class="btn primary hidden" id="btnNext2" type="button">Συνέχεια</button>
          </div>

          <div class="puzzleMini hidden" id="puzzleMini">
            Συγνώμηηη δεν άντεξα...
          </div>
        </div>
      </section>

      <!-- STEP 2: HOLD WORDS -->
      <section class="step" id="step3">
        <div class="card hero oneCol heartStep">
          <div class="holdWordsWrap" id="holdWordsWrap" aria-label="Κράτα πατημένο">
            <div class="holdWordsGlow"></div>
            <div class="holdWordsBig" id="holdWordsBig">Κράτα…</div>

            <div class="holdWordsBar" aria-hidden="true">
              <div class="holdWordsBarFill" id="holdWordsBarFill"></div>
            </div>

            <div class="holdWordsHint" id="holdWordsHint">Κράτα για 3 δευτερόλεπτα 💘</div>
          </div>

          <button class="btn primary hidden" id="btnNextHoldWords" type="button">
            Συνέχεια ✨
          </button>
        </div>
      </section>

      <!-- STEP 3: Song -->
      <section class="step" id="step4">
        <div class="card reveal">
          <div class="revealTitle">🎵 Το τραγούδι μας</div>

          <div class="revealBody">
            <div style="opacity:.9; margin-bottom:10px;">
              Αυτό το τραγούδι μου θυμίζει εμάς.
            </div>

            <iframe data-testid="embed-iframe" style="border-radius:12px"
              src="https://open.spotify.com/embed/track/0OwbEVwC2w9CgtS3RYcQlv?utm_source=generator"
              width="100%" height="352" frameBorder="0" allowfullscreen=""
              allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              loading="lazy"></iframe>

          </div>

          <div class="actionCenter">
            <button class="btn primary" id="btnNext4" type="button">Συνέχεια</button>
          </div>

        </div>
      </section>

      <!-- STEP 4: Voice -->
      <section class="step" id="step5">
        <div class="card reveal">
          <div class="revealTitle">💌 Η φωνή μου</div>
          <div class="revealBody" id="audioBox"></div>
          <div class="actionCenter">
            <button class="btn primary" id="btnNext5" type="button">Συνέχεια</button>
          </div>
        </div>
      </section>

      <!-- STEP 5: QUIZ -->
      <section class="step" id="stepQuiz">
        <div class="card reveal">
          <div class="revealTitle">🧠 Quiz για εμάς</div>
          <p class="p" style="opacity:.9">3 μικρές ερωτήσεις… αν σε ξέρω καλά 💘</p>

          <div class="quizBox" id="quizBox"></div>

          <div class="quizActions">
            <button class="btn ghost" id="btnQuizPrev" type="button">Πίσω</button>
            <button class="btn primary" id="btnQuizNext" type="button">Επόμενο</button>
          </div>

          <div class="quizMini hidden" id="quizMiniEnd">
            Ελπίζω να τα βρήκες όλα 💘
          </div>

          <div class="actionCenter hidden" id="quizContinueWrap">
            <button class="btn primary" id="btnQuizContinue" type="button">Συνέχεια ✨</button>
          </div>
        </div>
      </section>

      <!-- STEP 6: Future -->
      <section class="step" id="stepFuture">
        <div class="card">
          <h2 class="h2">💍 Το μέλλον μας</h2>
          <p class="p">Μερικά πράγματα που θέλω να ζήσουμε μαζί…</p>

          <div class="panel" id="futurePanel">
            Πάτα “Δείξε μου” — έχω κρύψει μικρά όνειρα για εμάς εδώ μέσα. 💘
          </div>
          <div class="actionCenter">
            <button class="btn primary" id="btnFutureNext" type="button">Δείξε μου</button>
          </div>
        </div>
      </section>

      <!-- STEP US: ΕΜΕΙΣ -->
      <section class="step" id="stepUs">
        <div class="card">
          <h2 class="h2">🤍 Εμείς</h2>
          <p class="p">Ένα μικρό “σπίτι” για τη σχέση μας. Μένει εδώ… και μεγαλώνει μαζί μας.</p>

          <div class="panel usPanel">
            <div class="usGrid">
              <button class="btn primary" id="btnUsDaily" type="button">🎯 Ερώτηση Ημέρας</button>
              <button class="btn ghost" id="btnUsMemories" type="button">📸 Στιγμές</button>

              <!-- ✅ FIX: id ΠΡΕΠΕΙ να είναι btnUsNotes (όχι btnUsDiary) -->
              <button class="btn ghost" id="btnUsNotes" type="button">📔 Ημερολόγιο</button>
            </div>

            <div class="usBox" id="usBox">
              Πάτα ένα κουμπί… 💘
            </div>
          </div>

          <div class="actionCenter" style="margin-top:12px;">
            <button class="btn ghost" id="btnUsBack" type="button">⬅ Πίσω</button>
            <button class="btn primary" id="btnUsGoVal" type="button">🩷 Πήγαινέ με στον Βαλεντίνο</button>
          </div>
        </div>
      </section>

      <!-- STEP MOMENTS -->
      <section class="step" id="stepMoments">
        <div class="card momentsPage">
          <div class="momTop">
            <button class="btn ghost" id="btnMomBack" type="button">⬅ Πίσω</button>
            <div class="momTitle">📸 Στιγμές</div>
            <button class="btn primary" id="btnMomAddOpen" type="button">＋</button>
          </div>

          <div class="momGrid" id="momGrid"></div>

          <div class="momReels hidden" id="momReels" aria-hidden="true">
            <button class="momReelsClose" id="momReelsClose" type="button">✕</button>
            <div class="momReelsHint">σύρε πάνω/κάτω 💘</div>
            <div class="momReelsList" id="momReelsList"></div>
          </div>

          <div class="momAdd hidden" id="momAdd">
            <div class="momAddBackdrop" id="momAddBackdrop"></div>
            <div class="momAddCard">
              <div style="font-weight:900; margin-bottom:10px;">➕ Νέα Στιγμή</div>

              <input id="momentFile" type="file" accept="image/*" hidden>
              <button class="btn ghost" id="pickPhoto" type="button">📷 Διάλεξε φωτογραφία</button>

              <input id="momentCaption" placeholder="Γράψε λεζάντα..." style="width:100%; padding:12px; border-radius:14px;">
              <div class="momActions">
                <button class="btn ghost" id="btnCancelMoment" type="button">Ακύρωση</button>
                <button class="btn primary" id="btnAddMoment" type="button">Ανέβασε</button>
              </div>

              <div id="momentStatus" style="opacity:.8; margin-top:10px; font-size:13px;"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ✅ STEP DIARY (Calendar + list + modal add/edit) -->
      <section class="step" id="stepDiary">
        <div class="card diaryPage">

          <div class="calTop">
            <div class="calTopRow">
              <button class="btn ghost" id="btnDiaryBack" type="button">⬅ Πίσω</button>
              <button class="btn primary" id="btnDiaryAddOpen" type="button">＋</button>
            </div>

            <div class="calHeader">
              <button class="calNav" id="calPrev" type="button" aria-label="Προηγούμενος μήνας">‹</button>
              <div class="calTitle" id="calTitle"></div>
              <button class="calNav" id="calNext" type="button" aria-label="Επόμενος μήνας">›</button>
            </div>
          </div>

          <!-- weekdays will be filled by JS -->
          <div class="calWeekdays" id="calWeekdays" aria-hidden="true"></div>

          <div class="calGrid" id="calGrid" aria-label="Ημερολόγιο"></div>

          <div class="calDayPanel">
            <div class="calDayTitle" id="calDayTitle">—</div>
            <div class="calDayHint" id="calDayHint">Σημειώσεις για αυτή τη μέρα:</div>

            <div class="diaryListFull" id="diaryListFull"></div>

            <textarea id="diaryText" class="diaryTextarea" placeholder="Γράψε κάτι για αυτή τη μέρα..."></textarea>

            <div class="diaryActions">
              <button class="btn primary" id="diarySave" type="button">Αποθήκευση</button>
              <button class="btn ghost hidden" id="diaryCancelEdit" type="button">Άκυρο</button>
            </div>

            <div class="diaryStatus" id="diaryStatus" style="opacity:.8; margin-top:10px; font-size:13px;"></div>
          </div>

        </div>
      </section>

      <!-- STEP 7: Final -->
      <section class="step" id="step7">
        <div class="card">
          <h2 class="h2">❓ Μια υπόσχεση</h2>
          <p class="p bigQ" id="finalQuestion">
            Υπόσχεσαι να είσαι και του χρόνου ο Βαλεντίνος μου;
          </p>

          <div class="actionCenter">
            <button class="btn primary" id="btnYes" type="button">Ναι ❤️</button>
          </div>

          <div class="quote" style="margin-top:10px;">
            «Ό,τι κι αν έρθει… θέλω να είσαι εσύ.»
          </div>
        </div>
      </section>

    </main>

    <!-- MODAL -->
    <div class="modal hidden" id="modal" role="dialog" aria-modal="true">
      <div class="modalCard">
        <div class="modalIcon">💘</div>
        <div class="modalTitle" id="modalTitle">🥹</div>
        <div class="modalText" id="modalText"></div>
        <div class="modalButtons">
          <button class="btn primary" id="modalClose" type="button">ΟΚ</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="app.js"></script>

  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js");
    }
  </script>
</body>
</html>
